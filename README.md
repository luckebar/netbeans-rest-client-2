# NetBeans REST Client 2

**NetBeans REST Client 2** is a NetBeans IDE plugin for exploring and testing REST APIs directly from your editor. Create requests, manage environments, parameterize variables, and inspect responses without leaving NetBeans — with all configurations saved inside your project.

---

## Features

- **Send HTTP Requests**  
  Execute `GET`, `POST`, `PUT`, `PATCH`, `DELETE`, `HEAD`, `OPTIONS`.

- **Headers & Body Editor**  
  Add custom headers; send raw text, JSON, XML, or form payloads.

- **Environment Management**  
  Define variables per environment (e.g., `DEV`, `STAGING`, `PROD`) and switch instantly.

- **Save & Reuse Configurations**  
  Store requests and environments in `.rstopt`.

- **Import/Export Environments**  
  Export one or more environment configurations to portable **`.rstcli`** files and import them back into your main **`.rstopt`**. Ideal for sharing environment setups across teams.
  - Export: **Tools → REST Client → Environments… → Export…**
  - Import: **Tools → REST Client → Environments… → Import…**

- **Authentication & Authorization (Rich)**  
  - **Basic Auth**
  - **Bearer Token** (manual)
  - **OAuth 2.0 – Client Credentials**
  - **OAuth 2.0 – Authorization Code with PKCE**

- **Response Viewer**  
  Inspect status, headers, and body with pretty-print for JSON/XML/HTML.

- **History & Favorites**  
  Re-run recent requests and pin common ones.

---

## Installation

1. Download the plugin `.nbm` from **Releases**.
2. In NetBeans: **Tools → Plugins → Downloaded → Add Plugins…**
3. Select the `.nbm` and complete the wizard.
4. Restart NetBeans.

---

## Getting Started

1. Create or open a **`.rstopt`** configuration.  
   _[screenshot: `docs/img/open-rstopt.png`]_
2. Pick an **Environment** (optional), set **Method**, **URL**, **Headers**, and **Body**.
3. Click **Send**.  
   _[screenshot: `docs/img/send-request.png`]_

---

## File Types

- **`.rstopt`** — Main workspace containing saved requests and environment definitions.
- **`.rstcli`** — Portable environment file for **export/import**.

---

## Environments & the new `.rstcli` flow

Use environments to centralize variables like `BASE_URL`, `ACCESS_TOKEN`, `CLIENT_ID`, etc.

- **Export environments to `.rstcli`:**  
  **Tools → REST Client → Environments… → Export…** → choose one or more environments → **Save**  
  _[screenshot: `docs/img/env-export.png`]_

- **Import environments from `.rstcli`:**  
  **Tools → REST Client → Environments… → Import…** → pick a `.rstcli` → **Import**  
  _[screenshot: `docs/img/env-import.png`]_

> **Tip:** Share `.rstcli` files without secrets; teammates can fill credentials locally.

---

## Authentication & Authorization

You can configure auth **per request** via the **Authentication** panel in the request editor.

> **Header precedence:** If you manually add an `Authorization` header, it overrides the one generated by the selected auth method.

### Basic Authentication

- Open **Authentication** → select **Basic**.  
  Fields: **Username**, **Password** (supports `${ENV_VAR}` references).  
  _[screenshot: `docs/img/auth-basic.png`]_

**What gets sent**
```
Authorization: Basic base64(username:password)
```

---

### Bearer Token (Manual)

- Open **Authentication** → select **Bearer (Manual)**.  
  Field: **Access Token** (paste directly or use `${ACCESS_TOKEN}`).  
  Optional: **Copy** / **Clear** buttons for convenience.  
  _[screenshot: `docs/img/auth-bearer.png`]_

**What gets sent**
```
Authorization: Bearer <token>
```

> **Tip:** Store the token in an environment variable and reference it (`${ACCESS_TOKEN}`) so you can rotate it without editing multiple requests.

---

### OAuth 2.0 — Client Credentials

Use for **machine-to-machine** scenarios.

- Open **Authentication** → **OAuth 2.0** → **Client Credentials**.  
  Fields:
  - **Token URL** (e.g., `https://auth.example.com/oauth2/token`)
  - **Client ID**
  - **Client Secret** (recommend `${CLIENT_SECRET}`)
  - **Scopes** (space-separated, optional)
  - **Audience/Resource** (optional, if your IdP requires it)
  Buttons:
  - **Get Token** — performs the `client_credentials` grant
  - **Refresh** — requests a fresh token (if supported)
  - **Copy** / **Clear**

_[screenshot: `docs/img/oauth-client-credentials.png`]_

**Result**
```
Authorization: Bearer <access_token>
```

**Best practices**
- Keep secrets in environments (`${CLIENT_SECRET}`).
- If your IdP needs additional parameters (e.g., `audience`), include them in the form if present or as advanced fields.

---

### OAuth 2.0 — Authorization Code with PKCE

Use for **user-delegated** flows (interactive login).

- Open **Authentication** → **OAuth 2.0** → **Authorization Code (PKCE)**.  
  Fields:
  - **Authorization URL**
  - **Token URL**
  - **Client ID** (public client)
  - **Redirect URI**
  - **Scopes** (space-separated)
  - **PKCE Method** (typically **S256**)
  - **State** (optional)
  Buttons:
  - **Start Authorization** — opens browser for login/consent
  - **Refresh Token** — exchanges `refresh_token` for a new `access_token` (if available)
  - **Copy** / **Clear**

_[screenshot: `docs/img/oauth-pkce.png`]_

**Flow**
1. **Start Authorization** → browser opens → sign in and consent.
2. The client captures the **authorization code** from the redirect and exchanges it for an **access token** (and **refresh token** if granted).
3. The request includes:
   ```
   Authorization: Bearer <access_token>
   ```

**Common pitfalls**
- **redirect_uri_mismatch**: The **Redirect URI** must match exactly what’s registered in your IdP.
- Missing **scopes** or **audience/resource** can cause 401/403 on the API even with a valid token.

---

### Token storage & security

- Avoid committing secrets or tokens to version control.
- Prefer environment variables (e.g., `${CLIENT_SECRET}`, `${ACCESS_TOKEN}`).
- Rotate tokens regularly; use **Refresh Token** when available.

---

## Examples (snippets)

**Environment variables (concept)**
```
BASE_URL=https://api.dev.example.com
CLIENT_ID=dev-public-client-id
CLIENT_SECRET=dev-super-secret
AUTH_URL=https://auth.dev.example.com/oauth2/authorize
TOKEN_URL=https://auth.dev.example.com/oauth2/token
SCOPES=openid profile offline_access api.read api.write
ACCESS_TOKEN=eyJhbGciOi...
```

**Manual Bearer header (env-driven)**
```
Authorization: Bearer ${ACCESS_TOKEN}
```

**URL with env var**
```
GET ${BASE_URL}/v1/customers
```

---

## Troubleshooting

- **401/403 with OAuth tokens** — Verify **scopes**, **audience/resource**, and API-side roles/permissions.
- **invalid_client / unauthorized_client** — Check **Client ID/Secret** and that the selected grant is allowed for the client.
- **redirect_uri_mismatch** (PKCE) — Ensure the **Redirect URI** matches your IdP registration exactly.
- **invalid_grant** on refresh — Refresh token expired/revoked; run **Start Authorization** again.
- **Tokens immediately “expired”** — Fix system clock (NTP).

---

## Roadmap

- Additional OAuth helpers (introspection/revocation).
- Bulk environment editing.
- Pre-request scripting/hooks.

---

## License

This project is licensed under the [Apache License 2.0](LICENSE).
